{"version":3,"file":"Acronym.js","names":["filePath","__dirname","split","slice","join","AcronymDAO","constructor","path","dbData","fs","readFileSync","JSON","parse","acronyms","length","writeFileSync","findAll","from","limit","search","keys","map","acronym","Object","searched","fuzzySearch","searchdata","filter","find","d","leftNum","data","header","findByKey","key","hasOwnProperty","create","definition","createdData","newData","stringify","updateByKey","updateddData","destroy","Acronym"],"sources":["../../../../src/db/models/Acronym.js"],"sourcesContent":["/* eslint-disable no-undef */\r\n/* eslint-disable node/no-unsupported-features/es-syntax */\r\n/* eslint-disable no-prototype-builtins */\r\n\r\n/**\r\n * fake model\r\n */\r\nimport fs from 'fs'\r\nimport { search as fuzzySearch } from 'fast-fuzzy'\r\n\r\nconst filePath = `${__dirname.split('\\\\').slice(0, -1).join('/')}/acronym.json`\r\n\r\nclass AcronymDAO {\r\n  constructor(path) {\r\n    try {\r\n      let dbData = fs.readFileSync(path)\r\n      dbData = JSON.parse(dbData)\r\n      this.acronyms =\r\n        typeof dbData === 'object' && dbData?.length >= 0\r\n          ? dbData\r\n          : fs.writeFileSync(path, '[]')\r\n      this.path = path\r\n    } catch {\r\n      fs.writeFileSync(path, '[]')\r\n    }\r\n  }\r\n\r\n  async findAll(from = 0, limit = 10, search = '') {\r\n    const keys = await this.acronyms.map((acronym) => Object.keys(acronym)[0])\r\n\r\n    const searched = !search ? keys : fuzzySearch(search, keys)\r\n\r\n    const searchdata = await this.acronyms.filter((acronym) =>\r\n      searched.find((d) => d === Object.keys(acronym)[0])\r\n    )\r\n    const leftNum = searchdata.length - from - limit\r\n    const data = {\r\n      header: `${leftNum >= 0 ? leftNum : 0}`,\r\n      data: await searchdata.slice(from, from + limit),\r\n    }\r\n    return data\r\n  }\r\n\r\n  async findByKey(key) {\r\n    const acronym = await this.acronyms.find((d) => d.hasOwnProperty(key))\r\n\r\n    return acronym\r\n  }\r\n\r\n  async create({ acronym, definition }) {\r\n    const createdData = JSON.parse(`{\"${acronym}\" : \"${definition}\"}`)\r\n    const newData = [...this.acronyms, createdData]\r\n\r\n    try {\r\n      fs.writeFileSync(this.path, JSON.stringify(newData))\r\n    } catch {\r\n      return null\r\n    }\r\n\r\n    return createdData\r\n  }\r\n\r\n  async updateByKey(key, { acronym, definition }) {\r\n    const updateddData = JSON.parse(`{\"${acronym}\" : \"${definition}\"}`)\r\n    const newData = await this.acronyms.map((d) =>\r\n      d.hasOwnProperty(key) ? updateddData : d\r\n    )\r\n\r\n    try {\r\n      fs.writeFileSync(this.path, JSON.stringify(newData))\r\n    } catch {\r\n      return null\r\n    }\r\n\r\n    return updateddData\r\n  }\r\n\r\n  async destroy(acronym) {\r\n    const newData = this.acronyms.filter((d) => !d.hasOwnProperty(acronym))\r\n\r\n    try {\r\n      await fs.writeFileSync(this.path, JSON.stringify(newData))\r\n    } catch {\r\n      return null\r\n    }\r\n\r\n    return true\r\n  }\r\n}\r\n\r\nconst Acronym = new AcronymDAO(filePath)\r\n\r\nexport default Acronym\r\n"],"mappings":"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"}