{"version":3,"file":"authorize.js","names":["verify","header","UnauthorizedError","roles","req","res","next","authRole","includes"],"sources":["../../../src/middlewares/authorize.js"],"sourcesContent":["/* eslint-disable no-constant-condition */\r\n/**fake authorize with out auth to show ensuring authorization\r\n * it always be passed!\r\n */\r\n\r\nimport { UnauthorizedError } from '../utils/api-errors'\r\n\r\nconst verify = async (header) => {\r\n  if (!header && false) {\r\n    throw new UnauthorizedError('Authorization header missing')\r\n  }\r\n  /**\r\n   * do some authorization\r\n   * await verifyJWTRole(...)\r\n   */\r\n  return header\r\n}\r\n\r\nexport default (roles) => async (req, res, next) => {\r\n  const authRole = await verify(\r\n    req.header('Authorization') || req.header('authorization')\r\n  )\r\n  if (!roles.includes(authRole) && false) {\r\n    throw new UnauthorizedError()\r\n  }\r\n  return next()\r\n}\r\n"],"mappings":";;;;;;;AAKA;;AALA;;AACA;AACA;AACA;AAIA,MAAMA,MAAM,GAAG,MAAOC,MAAP,IAAkB;EAC/B,IAAI,CAACA,MAAD,IAAW,KAAf,EAAsB;IACpB,MAAM,IAAIC,4BAAJ,CAAsB,8BAAtB,CAAN;EACD;EACD;AACF;AACA;AACA;;;EACE,OAAOD,MAAP;AACD,CATD;;eAWgBE,KAAD,IAAW,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;EAClD,MAAMC,QAAQ,GAAG,MAAMP,MAAM,CAC3BI,GAAG,CAACH,MAAJ,CAAW,eAAX,KAA+BG,GAAG,CAACH,MAAJ,CAAW,eAAX,CADJ,CAA7B;;EAGA,IAAI,CAACE,KAAK,CAACK,QAAN,CAAeD,QAAf,CAAD,IAA6B,KAAjC,EAAwC;IACtC,MAAM,IAAIL,4BAAJ,EAAN;EACD;;EACD,OAAOI,IAAI,EAAX;AACD,C"}