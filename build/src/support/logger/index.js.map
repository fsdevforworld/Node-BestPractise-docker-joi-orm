{"version":3,"file":"index.js","names":["logFormatter","winston","format","printf","info","timestamp","level","stack","message","errorMessage","symbols","Object","getOwnPropertySymbols","logger","createLogger","maxsize","maxFiles","combine","errors","splat","json","defaultMeta","service","packageName","name","toLocaleLowerCase","transports","Console","colorize","NODE_ENV","add","File","filename","requestLogger","expressWinston","prettyPrint","meta","msg","expressFormat","ignoreRoute","req","res"],"sources":["../../../../src/support/logger/index.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\r\nimport winston from 'winston'\r\nimport { NODE_ENV } from 'config'\r\n\r\nimport expressWinston from 'express-winston'\r\nimport packageName from '../../../package.json'\r\n\r\nconst logFormatter = winston.format.printf((info) => {\r\n  const { timestamp, level, stack, message } = info\r\n  const errorMessage = stack || message\r\n\r\n  const symbols = Object.getOwnPropertySymbols(info)\r\n  if (info[symbols[0]] !== 'error') {\r\n    return `${timestamp} ${level}: ${message}`\r\n  }\r\n\r\n  return `${timestamp} ${level}: ${errorMessage}`\r\n})\r\n\r\nconst logger = winston.createLogger({\r\n  maxsize: 5242880, // 5MB\r\n  maxFiles: 5,\r\n  level: 'debug',\r\n  format: winston.format.combine(\r\n    winston.format.timestamp({\r\n      format: 'YYYY-MM-DD HH:mm:ss',\r\n    }),\r\n    winston.format.errors({ stack: true }),\r\n    winston.format.splat(),\r\n    winston.format.json()\r\n  ),\r\n  defaultMeta: { service: `${packageName.name.toLocaleLowerCase()}-service` },\r\n  transports: [\r\n    new winston.transports.Console({\r\n      format: winston.format.combine(winston.format.colorize(), logFormatter),\r\n    }),\r\n  ],\r\n})\r\n\r\nif (NODE_ENV === 'production') {\r\n  logger.add(\r\n    new winston.transports.File({ filename: 'logs/error.log', level: 'error' })\r\n  )\r\n  logger.add(\r\n    new winston.transports.File({\r\n      filename: 'logs/combined.log',\r\n      level: 'debug',\r\n    })\r\n  )\r\n}\r\n\r\nconst requestLogger = expressWinston.logger({\r\n  transports: [new winston.transports.Console()],\r\n  format: winston.format.combine(\r\n    winston.format.json(),\r\n    winston.format.prettyPrint()\r\n  ),\r\n  meta: true,\r\n  msg: 'HTTP {{req.method}} {{req.url}}',\r\n  expressFormat: true,\r\n  colorize: false,\r\n  ignoreRoute(req, res) {\r\n    return false\r\n  },\r\n})\r\n\r\nexport { logger, requestLogger }\r\n"],"mappings":";;;;;;;AACA;;AACA;;AAEA;;AACA;;;;AALA;AAOA,MAAMA,YAAY,GAAGC,gBAAA,CAAQC,MAAR,CAAeC,MAAf,CAAuBC,IAAD,IAAU;EACnD,MAAM;IAAEC,SAAF;IAAaC,KAAb;IAAoBC,KAApB;IAA2BC;EAA3B,IAAuCJ,IAA7C;EACA,MAAMK,YAAY,GAAGF,KAAK,IAAIC,OAA9B;EAEA,MAAME,OAAO,GAAGC,MAAM,CAACC,qBAAP,CAA6BR,IAA7B,CAAhB;;EACA,IAAIA,IAAI,CAACM,OAAO,CAAC,CAAD,CAAR,CAAJ,KAAqB,OAAzB,EAAkC;IAChC,OAAQ,GAAEL,SAAU,IAAGC,KAAM,KAAIE,OAAQ,EAAzC;EACD;;EAED,OAAQ,GAAEH,SAAU,IAAGC,KAAM,KAAIG,YAAa,EAA9C;AACD,CAVoB,CAArB;;AAYA,MAAMI,MAAM,GAAGZ,gBAAA,CAAQa,YAAR,CAAqB;EAClCC,OAAO,EAAE,OADyB;EAChB;EAClBC,QAAQ,EAAE,CAFwB;EAGlCV,KAAK,EAAE,OAH2B;EAIlCJ,MAAM,EAAED,gBAAA,CAAQC,MAAR,CAAee,OAAf,CACNhB,gBAAA,CAAQC,MAAR,CAAeG,SAAf,CAAyB;IACvBH,MAAM,EAAE;EADe,CAAzB,CADM,EAIND,gBAAA,CAAQC,MAAR,CAAegB,MAAf,CAAsB;IAAEX,KAAK,EAAE;EAAT,CAAtB,CAJM,EAKNN,gBAAA,CAAQC,MAAR,CAAeiB,KAAf,EALM,EAMNlB,gBAAA,CAAQC,MAAR,CAAekB,IAAf,EANM,CAJ0B;EAYlCC,WAAW,EAAE;IAAEC,OAAO,EAAG,GAAEC,gBAAA,CAAYC,IAAZ,CAAiBC,iBAAjB,EAAqC;EAAnD,CAZqB;EAalCC,UAAU,EAAE,CACV,IAAIzB,gBAAA,CAAQyB,UAAR,CAAmBC,OAAvB,CAA+B;IAC7BzB,MAAM,EAAED,gBAAA,CAAQC,MAAR,CAAee,OAAf,CAAuBhB,gBAAA,CAAQC,MAAR,CAAe0B,QAAf,EAAvB,EAAkD5B,YAAlD;EADqB,CAA/B,CADU;AAbsB,CAArB,CAAf;;;;AAoBA,IAAI6B,gBAAA,KAAa,YAAjB,EAA+B;EAC7BhB,MAAM,CAACiB,GAAP,CACE,IAAI7B,gBAAA,CAAQyB,UAAR,CAAmBK,IAAvB,CAA4B;IAAEC,QAAQ,EAAE,gBAAZ;IAA8B1B,KAAK,EAAE;EAArC,CAA5B,CADF;EAGAO,MAAM,CAACiB,GAAP,CACE,IAAI7B,gBAAA,CAAQyB,UAAR,CAAmBK,IAAvB,CAA4B;IAC1BC,QAAQ,EAAE,mBADgB;IAE1B1B,KAAK,EAAE;EAFmB,CAA5B,CADF;AAMD;;AAED,MAAM2B,aAAa,GAAGC,uBAAA,CAAerB,MAAf,CAAsB;EAC1Ca,UAAU,EAAE,CAAC,IAAIzB,gBAAA,CAAQyB,UAAR,CAAmBC,OAAvB,EAAD,CAD8B;EAE1CzB,MAAM,EAAED,gBAAA,CAAQC,MAAR,CAAee,OAAf,CACNhB,gBAAA,CAAQC,MAAR,CAAekB,IAAf,EADM,EAENnB,gBAAA,CAAQC,MAAR,CAAeiC,WAAf,EAFM,CAFkC;EAM1CC,IAAI,EAAE,IANoC;EAO1CC,GAAG,EAAE,iCAPqC;EAQ1CC,aAAa,EAAE,IAR2B;EAS1CV,QAAQ,EAAE,KATgC;;EAU1CW,WAAW,CAACC,GAAD,EAAMC,GAAN,EAAW;IACpB,OAAO,KAAP;EACD;;AAZyC,CAAtB,CAAtB"}